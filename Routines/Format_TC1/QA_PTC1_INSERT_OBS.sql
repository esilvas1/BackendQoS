CREATE OR REPLACE PROCEDURE BRAE.QA_PTC1_INSERT_OBS(FECHAOPERACION IN  DATE, USR IN VARCHAR2, ESTADO OUT NUMBER)
AS


BEGIN
	
  INSERT INTO QA_TTC1_TEMP
  SELECT TC1_TC1 --Verificar duplicidad de usuario
		,TC1_CODCONEX --Verificar
		,TC1_TIPCONEX --Verificar
		,TC1_NT
		,TC1_NTP
		,TC1_PROPACTIV
		,TC1_CONEXRED 
		,TC1_IDCOMER --Verificar duplicidad de usuario
		,TC1_IDMERC --Asignar
		,TC1_GC --Asignar
		,TC1_CODFRONCOM
		,TC1_CODCIRC --Asignar
		,TC1_CODTRANSF --Asignar
		,TC1_CODDANE --Verificar
		,TC1_UBIC
		,TC1_DIREC
		,TC1_CONESP
		,TC1_CODARESP
		,TC1_TIPARESP
		,TC1_ESTSECT
		,TC1_ALTITUD --Formatear
		,TC1_LONGITUD --Formatear
		,TC1_LATITUD --Formatear
		,TC1_AUTOGEN
		,TC1_EXPENER
		,TC1_CAPAUTOGENR
		,TC1_TIPGENR
		,TC1_CODFRONEXP
		,TC1_FENTGEN
		,TC1_CONTRESP
		,TC1_CAPCONTRESP
		,NULL TC1_PERIODO --Asignar
		,NULL TC1_IUA --Asignar 
	FROM  QA_TTC1_OBS 
	WHERE TC1_PERIODO = TO_CHAR(FECHAOPERACION,'YYYYMM')
	AND   TC1_TC1 = USR;
	COMMIT;

END QA_PTC1_INSERT_OBS;


