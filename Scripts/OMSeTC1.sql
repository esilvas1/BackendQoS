SELECT I.MINICIAL, I.TRAFO, T.TC1_CODCONEX 
FROM OMS.INTERUPC@OMSPROD I
LEFT OUTER JOIN OMS.MANIOBRAS@OMSPROD M ON I.MINICIAL=M.CODE
LEFT OUTER JOIN TRAFOS_TC1 T ON T.TC1_CODCONEX = I.TRAFO
WHERE I.FINICIAL >= '01/06/2019'
AND I.FINICIAL <'25/06/2019'
AND M.CAUSA <> 'PRUEBA'
AND M.TIPO <> 'PRUEBA'
AND I.TYPEEQUIP ='Transformer'
AND T.TC1_CODCONEX IS NOT NULL
UNION ALL
SELECT I.MINICIAL, I.TRAFO, T.TC1_CODCONEX 
FROM OMS.INTERUPC@OMSPROD I
LEFT OUTER JOIN OMS.MANIOBRAS@OMSPROD M ON I.MINICIAL=M.CODE
LEFT OUTER JOIN TRAFOS_TC1_2 T ON T.TC1_CODCONEX = I.TRAFO
WHERE I.FINICIAL >= '25/06/2019'
AND I.FINICIAL <'01/07/2019'
AND M.CAUSA <> 'PRUEBA'
AND M.TIPO <> 'PRUEBA'
AND I.TYPEEQUIP ='Transformer'
AND T.TC1_CODCONEX IS NOT NULL;




CREATE VIEW TRAFOS_TC1 
 AS (SELECT DISTINCT(TC1_CODCONEX) FROM QA_TTC1 WHERE TC1_PERIODO IN (201904))
;


CREATE VIEW TRAFOS_TC1_2 
 AS (SELECT DISTINCT(TC1_CODCONEX) FROM QA_TTC1 WHERE TC1_PERIODO IN (201905))
;

SELECT *--DISTINCT (FDD_CODIGOEVENTO) 
FROM QA_TFDDREGISTRO 
WHERE FDD_CODIGOEVENTO IN (SELECT DISTINCT (FDD_CODIGOEVENTO) FROM QA_TFDDREGISTRO_NR);


SELECT count(*) FROM QA_TFDDREPORTE 
ORDER BY FDR_CODIGOEVENTO,FDR_CODIGOELEMENTO;



--ALTER TABLE QA_TFDDREGISTRO
--ADD FDD_RADICADO VARCHAR2(30 BYTE) DEFAULT 'NA';





SELECT * FROM QA_TFDDREPORTE
WHERE FDR_CODIGOEVENTO<>'NA' 
ORDER BY FDR_CODIGOEVENTO,FDR_CODIGOELEMENTO;

;--WHERE FDR_CODIGOEVENTO IN ('654406',    '654414',    '654421',    '654432',    '654460',    '654469',    '654484',    '654496',    '654613',    '654616',    '654629',    '654635',    '654637',    '654643',    '654646',    '654649')
--AND FDD_CODIGOELEMENTO NOT IN ('1T02280',    '1T08581',    '1T04290',    '1T07735',    '1T07590',    '1T08785',    '1T02563',    '1T01385',    '1T01400',    '1T12476',    '1T08207',    '1T08441',    '1T02602',    '1T08961',    '5T00613',    '1T11656');
--WHERE FDD_PERIODO_OP='30/06/2019';

QA_TFDDREGISTRO_NR